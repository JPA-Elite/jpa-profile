{% extends "admin/dist/layout.html" %}

{% block title %}Admin | Conversation{% endblock %}

{% block content %}
<div class="app-content-header">
  <div class="container-fluid">
    <div class="row">
      <div class="col-sm-6">
        <h3 class="mb-0">Conversation</h3>
      </div>
      <div class="col-sm-6">
        <ol class="breadcrumb float-sm-end">
          <li class="breadcrumb-item"><a href="/admin/dashboard">Home</a></li>
          <li class="breadcrumb-item active" aria-current="page">Maintenance</li>
          <li class="breadcrumb-item active" aria-current="page">Conversation</li>
        </ol>
      </div>
    </div>
  </div>
</div>
<div class="app-content">
  <div class="container-fluid">
    <div class="row">
      <div class="col-12">
        <div class="card">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center pb-2">
              <div>
                <label for="perPageSelect" class="form-label me-2">Show</label>
                <select id="perPageSelect" class="form-select form-select-sm d-inline-block" style="width: auto;">
                  <option value="5">5</option>
                  <option value="10" selected>10</option>
                  <option value="20">20</option>
                  <option value="50">50</option>
                </select>
                <span>entries</span>
              </div>
              <div>
                <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#addConversationModal">
                  <i class="bi bi-plus-circle"></i> Add Conversation
                </button>
              </div>
              <div class="modal fade" id="addConversationModal" tabindex="-1" aria-labelledby="addConversationModalLabel"
                aria-hidden="true">
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title">Add New Conversation</h5>
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                      <form id="addConversationForm">
                        <div class="mb-3">
                          <label class="form-label">Title <span class="text-danger">*</span></label>
                          <input type="text" class="form-control" id="addTitle" required>
                        </div>
                        <div class="mb-3">
                          <label class="form-label">Artist <span class="text-danger">*</span></label>
                          <input type="text" class="form-control" id="addArtist" required>
                        </div>
                        <div class="mb-3">
                          <label class="form-label">Conversation File <span class="text-danger">*</span></label>
                          <input type="file" class="form-control" id="addConversationFile" accept="audio/*" required>
                        </div>
                        <!-- Desktop (Drag & Drop) -->
                        <div class="mb-3 d-none d-md-block">
                          <label class="form-label">Image File <span class="text-danger">*</span></label>
                          <div id="addDropZone" class="dropzone">
                            <p>Drag & Drop image here, or click to select</p>
                            <input type="file" id="addImageFile" accept="image/*" hidden required>
                          </div>
                        </div>

                        <!-- Mobile (Normal Input) -->
                        <div class="mb-3 d-md-none">
                          <label class="form-label">Image File <span class="text-danger">*</span></label>
                          <input type="file" class="form-control" id="addImageFileMobile" accept="image/*" required>
                        </div>

                      </form>
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                      <button type="button" class="btn btn-success" id="addConversationBtn"
                        data-loading-text='<span class="spinner-border spinner-border-sm me-2"></span> Saving...'
                        onclick="addConversation()">
                        Save
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <table class="table table-bordered table-hover">
              <thead class="table-light">
                <tr>
                  <th>#</th>
                  <th>Title</th>
                  <th>Artist</th>
                  <th>Preview</th>
                  <th>Image</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="conversationTableBody">
                <!-- Default loading row -->
                <tr>
                  <td colspan="6" class="text-center">Loading...</td>
                </tr>
              </tbody>
            </table>

            <!-- âœ… Pagination Controls -->
            <div class="d-flex justify-content-between align-items-center mt-3">
              <button id="prevPage" class="btn btn-outline-secondary btn-sm">Prev</button>
              <span id="pageInfo"></span>
              <button id="nextPage" class="btn btn-outline-secondary btn-sm">Next</button>
            </div>

            <div id="conversationModals"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="{{ url_for('static', filename='js/pages/admin/conversation.js') }}"></script>
{% endblock %}